'use strict';

(function (root) {

	function init() {
		$('.gallery__element').first().trigger('click');
	};

	$('.range__slider').each(function () {
		var range = this,
		    minInput = $(range).closest('.range').find('[data-input="min"]'),
		    maxInput = $(range).closest('.range').find('[data-input="max"]');

		function update() {
			var from = $(range).data('from'),
			    to = $(range).data('to');

			$(minInput).val(from);
			$(maxInput).val(to);
		}

		$(range).ionRangeSlider({
			extra_classes: 'range__slider',
			hide_min_max: true,
			hide_from_to: true
		});

		update();
		$(range).on('change', update);
	});

	$('[data-input]').on('change', function () {
		var range = $(this).closest('.range').find('input.range__slider').data("ionRangeSlider"),
		    val = $(this).val(),
		    min = range.options.min,
		    max = range.options.max,
		    from = range.options.from,
		    to = range.options.to,
		    step = range.options.step;

		switch ($(this).data('input')) {
			case 'min':
				if (val <= min) {
					val = min;
				} else if (val >= max) {
					val = max - step;
				} else if (val >= to) {
					val = to - step;
				}

				range.update({
					from: val
				});
				break;
			case 'max':
				if (val >= max) {
					val = max;
				} else if (val <= min) {
					val = min + step;
				} else if (val <= from) {
					val = from + step;
				}

				range.update({
					to: val
				});
				break;
		}

		$(this).val(val);
	});

	function filled(field) {
		var val = $(field).val().trim();

		if (val.length > 0) {
			$(field).closest('.field').addClass('field_filled');
		} else {
			$(field).closest('.field').removeClass('field_filled');
		}
	}

	$('.field input').each(function () {
		filled(this);
	});

	$('.toggle').on('click', function (e) {
		e.stopPropagation();
		var content = $(this).parent().find($('.' + $(this).data('toggle')));
		$(this).toggleClass('toggle_close');
		$(content).stop().slideToggle(300);
	});

	$('.filter__block-content').each(function (i, block) {
		var checks = $(block).find('.checkbox').length;

		if (checks > 5) {
			$(block).addClass('filter__block-content_more');
			$(block).append('<span class="filter__block-more">Показать все</span>');
		}
	});

	$('.filter__block-more').on('click', function () {
		$(this).parent().removeClass('filter__block-content_more');
		$(this).remove();
	});

	$('.drop__item').on('click', function () {
		if (!$(this).hasClass('drop__item_link')) {
			$(this).addClass('drop__item_active').siblings().removeClass('drop__item_active');
		}

		$(this).closest('[data-drop]').removeClass('drop-open');
	});

	$(document).on('click', '[data-drop]', function () {

		var data = $(this).data('drop');

		if (data == 'trigger') {
			$('.drop-open').removeClass('drop-open');
			$(this).parent().closest('[data-drop]').addClass('drop-open');
		} else return;
	});

	$(document).on('click', function (e) {

		var drop = $(e.target).parent().closest('[data-drop]').get(0),
		    tip = $(e.target).parent().closest('.tip').get(0);

		if (!drop) {
			$('.drop-open').removeClass('drop-open');
		}

		if (!tip) {
			$('.tip__hidecontent').hide();
		}
	});

	$('.description__show').on('click', function () {
		$(this).hide();
		$('.description__more').show();
	});

	$('.btn_in-cart').on('click', function () {
		$(this).addClass('btn_in-cart-add');
	});

	$('[data-close]').on('click', function () {
		$(this).parent().hide();
		$(this).closest('.card').css('z-index', '');
	});

	$('.tip__name').on('click', function () {
		$('.card').css('z-index', '');
		$('.tip__hidecontent').hide();
		$(this).parent().find('.tip__hidecontent').show();
		$(this).closest('.card').css('z-index', '2');
	});

	var dataSliders = {
		feautures: {
			items: 6,
			nav: true
		},
		gallery: {
			items: 4,
			nav: true,
			mouseDrag: false
		}
	};

	$('[data-slider]').each(function (i, slider) {
		var data = $(this).data('slider');

		$(slider).owlCarousel(dataSliders[data]);
	});

	// Gallery
	$('.gallery__element').on('click', function () {

		if ($(this).hasClass('gallery__element_video')) {
			var video = $(this).find('video').clone();

			$('.modal_zoom .modal__content').html(video);

			$('.modal_zoom').iziModal('open');
		} else {
			var img = $(this).find('img').clone();

			$(this).closest('.gallery').find('.gallery__view').empty().append(img);

			$(this).closest('.gallery__list').find('.gallery__element_active').removeClass('gallery__element_active');
			$(this).addClass('gallery__element_active');
		}
	});

	$('.vlist__more').on('click', function () {
		$(this).closest('.vlist').toggleClass('vlist_allshow');
	});

	$('[data-modal]').iziModal({
		width: 1180
	});

	$('.gallery__view').on('click', function () {
		var img = $(this).find('img').clone();

		$('.modal_zoom .modal__content').html(img);

		$('.modal_zoom').iziModal('open');
	});

	init();
})(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJyb290IiwiaW5pdCIsIiQiLCJmaXJzdCIsInRyaWdnZXIiLCJlYWNoIiwicmFuZ2UiLCJtaW5JbnB1dCIsImNsb3Nlc3QiLCJmaW5kIiwibWF4SW5wdXQiLCJ1cGRhdGUiLCJmcm9tIiwiZGF0YSIsInRvIiwidmFsIiwiaW9uUmFuZ2VTbGlkZXIiLCJleHRyYV9jbGFzc2VzIiwiaGlkZV9taW5fbWF4IiwiaGlkZV9mcm9tX3RvIiwib24iLCJtaW4iLCJvcHRpb25zIiwibWF4Iiwic3RlcCIsImZpbGxlZCIsImZpZWxkIiwidHJpbSIsImxlbmd0aCIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwiY29udGVudCIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwic3RvcCIsInNsaWRlVG9nZ2xlIiwiaSIsImJsb2NrIiwiY2hlY2tzIiwiYXBwZW5kIiwicmVtb3ZlIiwiaGFzQ2xhc3MiLCJzaWJsaW5ncyIsImRvY3VtZW50IiwiZHJvcCIsInRhcmdldCIsImdldCIsInRpcCIsImhpZGUiLCJzaG93IiwiY3NzIiwiZGF0YVNsaWRlcnMiLCJmZWF1dHVyZXMiLCJpdGVtcyIsIm5hdiIsImdhbGxlcnkiLCJtb3VzZURyYWciLCJzbGlkZXIiLCJvd2xDYXJvdXNlbCIsInZpZGVvIiwiY2xvbmUiLCJodG1sIiwiaXppTW9kYWwiLCJpbWciLCJlbXB0eSIsIndpZHRoIiwid2luZG93Il0sIm1hcHBpbmdzIjoiOztBQUFBLENBQUMsVUFBU0EsSUFBVCxFQUFlOztBQUVmLFVBQVNDLElBQVQsR0FBZ0I7QUFDZkMsSUFBRSxtQkFBRixFQUF1QkMsS0FBdkIsR0FBK0JDLE9BQS9CLENBQXVDLE9BQXZDO0FBQ0E7O0FBRURGLEdBQUUsZ0JBQUYsRUFBb0JHLElBQXBCLENBQXlCLFlBQVc7QUFDbkMsTUFBSUMsUUFBUSxJQUFaO0FBQUEsTUFDRUMsV0FBV0wsRUFBRUksS0FBRixFQUFTRSxPQUFULENB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OztBQUlBakMsR0FBRSxjQUFGLEVBQWtCOEQsUUFBbEIsQ0FBMkI7QUFDMUJHLFNBQU87QUFEbUIsRUFBM0I7O0FBSUFqRSxHQUFFLGdCQUFGLEVBQW9Ca0IsRUFBcEIsQ0FBdUIsT0FBdkIsRUFBZ0MsWUFBVztBQUMxQyxNQUFJNkMsTUFBTS9ELEVBQUUsSUFBRixFQUFRTyxJQUFSLENBQWEsS0FBYixFQUFvQnFELEtBQXBCLEVBQVY7O0FBRUE1RCxJQUFFLDZCQUFGLEVBQWlDNkQsSUFBakMsQ0FBc0NFLEdBQXRDOztBQUVBL0QsSUFBRSxhQUFGLEVBQWlCOEQsUUFBakIsQ0FBMEIsTUFBMUI7QUFDQSxFQU5EOztBQVFBL0Q7QUFFQSxDQTNORCxFQTJOR21FLE1BM05IIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbihyb290KSB7XG5cblx0ZnVuY3Rpb24gaW5pdCgpIHtcblx0XHQkKCcuZ2FsbGVyeV9fZWxlbWVudCcpLmZpcnN0KCkudHJpZ2dlcignY2xpY2snKTtcblx0fTtcblxuXHQkKCcucmFuZ2VfX3NsaWRlcicpLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHJhbmdlID0gdGhpcyxcblx0XHRcdFx0bWluSW5wdXQgPSAkKHJhbmdlKS5jbG9zZXN0KCcucmFuZ2UnKS5maW5kKCdbZGF0YS1pbnB1dD1cIm1pblwiXScpLFxuXHRcdFx0XHRtYXhJbnB1dCA9ICQocmFuZ2UpLmNsb3Nlc3QoJy5yYW5nZScpLmZpbmQoJ1tkYXRhLWlucHV0PVwibWF4XCJdJyk7XG5cblx0XHRmdW5jdGlvbiB1cGRhdGUoKSB7XG5cdFx0XHR2YXIgZnJvbSA9ICQocmFuZ2UpLmRhdGEoJ2Zyb20nKSxcblx0XHRcdFx0XHR0byA9ICQocmFuZ2UpLmRhdGEoJ3RvJyk7XG5cblx0XHRcdCQobWluSW5wdXQpLnZhbChmcm9tKTtcblx0XHRcdCQobWF4SW5wdXQpLnZhbCh0byk7XG5cdFx0fVxuXG5cdFx0JChyYW5nZSkuaW9uUmFuZ2VTbGlkZXIoe1xuXHRcdFx0ZXh0cmFfY2xhc3NlczogJ3JhbmdlX19zbGlkZXInLFxuXHRcdFx0aGlkZV9taW5fbWF4OiB0cnVlLFxuXHRcdFx0aGlkZV9mcm9tX3RvOiB0cnVlLFxuXHRcdH0pO1xuXG5cdFx0dXBkYXRlKCk7XG5cdFx0JChyYW5nZSkub24oJ2NoYW5nZScsIHVwZGF0ZSk7XG5cdH0pO1xuXG5cdCQoJ1tkYXRhLWlucHV0XScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgcmFuZ2UgPSAkKHRoaXMpLmNsb3Nlc3QoJy5yYW5nZScpLmZpbmQoJ2lucHV0LnJhbmdlX19zbGlkZXInKS5kYXRhKFwiaW9uUmFuZ2VTbGlkZXJcIiksXG5cdFx0XHRcdHZhbCA9ICQodGhpcykudmFsKCksXG5cdFx0XHRcdG1pbiA9IHJhbmdlLm9wdGlvbnMubWluLFxuXHRcdFx0XHRtYXggPSByYW5nZS5vcHRpb25zLm1heCxcblx0XHRcdFx0ZnJvbSA9IHJhbmdlLm9wdGlvbnMuZnJvbSxcblx0XHRcdFx0dG8gPSByYW5nZS5vcHRpb25zLnRvLFxuXHRcdFx0XHRzdGVwID0gcmFuZ2Uub3B0aW9ucy5zdGVwO1xuXG5cdFx0c3dpdGNoICgkKHRoaXMpLmRhdGEoJ2lucHV0JykpIHtcblx0XHRcdGNhc2UgJ21pbic6XG5cdFx0XHRcdGlmICh2YWwgPD0gbWluKSB7XG5cdFx0XHRcdFx0dmFsID0gbWluO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHZhbCA+PSBtYXgpIHtcblx0XHRcdFx0XHR2YWwgPSBtYXggLSBzdGVwO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHZhbCA+PSB0bykge1xuXHRcdFx0XHRcdHZhbCA9IHRvIC0gc3RlcDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJhbmdlLnVwZGF0ZSh7XG5cdFx0XHRcdFx0ZnJvbTogdmFsXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ21heCc6XG5cdFx0XHRcdGlmICh2YWwgPj0gbWF4KSB7XG5cdFx0XHRcdFx0dmFsID0gbWF4O1xuXHRcdFx0XHR9IGVsc2UgaWYgKHZhbCA8PSBtaW4pIHtcblx0XHRcdFx0XHR2YWwgPSBtaW4gKyBzdGVwO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHZhbCA8PSBmcm9tKSB7XG5cdFx0XHRcdFx0dmFsID0gZnJvbSArIHN0ZXA7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyYW5nZS51cGRhdGUoe1xuXHRcdFx0XHRcdHRvOiB2YWxcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdCQodGhpcykudmFsKHZhbCk7XG5cblx0fSk7XG5cblx0ZnVuY3Rpb24gZmlsbGVkKGZpZWxkKSB7XG5cdFx0dmFyIHZhbCA9ICQoZmllbGQpLnZhbCgpLnRyaW0oKTtcblxuXHRcdGlmICh2YWwubGVuZ3RoID4gMCkge1xuXHRcdFx0JChmaWVsZCkuY2xvc2VzdCgnLmZpZWxkJykuYWRkQ2xhc3MoJ2ZpZWxkX2ZpbGxlZCcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQkKGZpZWxkKS5jbG9zZXN0KCcuZmllbGQnKS5yZW1vdmVDbGFzcygnZmllbGRfZmlsbGVkJyk7XG5cdFx0fVxuXHR9XG5cblx0JCgnLmZpZWxkIGlucHV0JykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRmaWxsZWQodGhpcyk7XG5cdH0pO1xuXG5cdCQoJy50b2dnbGUnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKVxuXHRcdHZhciBjb250ZW50ID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCQoJy4nKyQodGhpcykuZGF0YSgndG9nZ2xlJykpKTtcblx0XHQkKHRoaXMpLnRvZ2dsZUNsYXNzKCd0b2dnbGVfY2xvc2UnKTtcblx0XHQkKGNvbnRlbnQpLnN0b3AoKS5zbGlkZVRvZ2dsZSgzMDApO1xuXHR9KTtcblxuXHQkKCcuZmlsdGVyX19ibG9jay1jb250ZW50JykuZWFjaChmdW5jdGlvbihpLCBibG9jaykge1xuXHRcdHZhciBjaGVja3MgPSAkKGJsb2NrKS5maW5kKCcuY2hlY2tib3gnKS5sZW5ndGg7XG5cblx0XHRpZiAoY2hlY2tzID4gNSkge1xuXHRcdFx0JChibG9jaykuYWRkQ2xhc3MoJ2ZpbHRlcl9fYmxvY2stY29udGVudF9tb3JlJyk7XG5cdFx0XHQkKGJsb2NrKS5hcHBlbmQoJzxzcGFuIGNsYXNzPVwiZmlsdGVyX19ibG9jay1tb3JlXCI+0J/QvtC60LDQt9Cw0YLRjCDQstGB0LU8L3NwYW4+Jyk7XG5cdFx0fVxuXHR9KTtcblxuXHQkKCcuZmlsdGVyX19ibG9jay1tb3JlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnZmlsdGVyX19ibG9jay1jb250ZW50X21vcmUnKTtcblx0XHQkKHRoaXMpLnJlbW92ZSgpO1xuXHR9KTtcblxuXHQkKCcuZHJvcF9faXRlbScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdGlmICghJCh0aGlzKS5oYXNDbGFzcygnZHJvcF9faXRlbV9saW5rJykpIHtcblx0XHRcdCQodGhpcykuYWRkQ2xhc3MoJ2Ryb3BfX2l0ZW1fYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnZHJvcF9faXRlbV9hY3RpdmUnKTtcblx0XHR9XG5cblx0XHQkKHRoaXMpLmNsb3Nlc3QoJ1tkYXRhLWRyb3BdJykucmVtb3ZlQ2xhc3MoJ2Ryb3Atb3BlbicpO1xuXHR9KTtcblxuXHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnW2RhdGEtZHJvcF0nLCBmdW5jdGlvbigpIHtcblxuXHRcdHZhciBkYXRhID0gJCh0aGlzKS5kYXRhKCdkcm9wJyk7XG5cblx0XHRpZiAoZGF0YSA9PSAndHJpZ2dlcicpIHtcblx0XHRcdCQoJy5kcm9wLW9wZW4nKS5yZW1vdmVDbGFzcygnZHJvcC1vcGVuJyk7XG5cdFx0XHQkKHRoaXMpLnBhcmVudCgpLmNsb3Nlc3QoJ1tkYXRhLWRyb3BdJykuYWRkQ2xhc3MoJ2Ryb3Atb3BlbicpO1xuXHRcdH0gZWxzZSByZXR1cm47XG5cblx0fSk7XG5cblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXG5cdFx0dmFyIGRyb3AgPSAkKGUudGFyZ2V0KS5wYXJlbnQoKS5jbG9zZXN0KCdbZGF0YS1kcm9wXScpLmdldCgwKSxcblx0XHRcdFx0dGlwID0gJChlLnRhcmdldCkucGFyZW50KCkuY2xvc2VzdCgnLnRpcCcpLmdldCgwKTtcblxuXHRcdGlmICghZHJvcCkge1xuXHRcdFx0JCgnLmRyb3Atb3BlbicpLnJlbW92ZUNsYXNzKCdkcm9wLW9wZW4nKTtcblx0XHR9XG5cblx0XHRpZiAoIXRpcCkge1xuXHRcdFx0JCgnLnRpcF9faGlkZWNvbnRlbnQnKS5oaWRlKCk7XG5cdFx0fVxuXG5cdH0pXG5cblx0JCgnLmRlc2NyaXB0aW9uX19zaG93Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5oaWRlKCk7XG5cdFx0JCgnLmRlc2NyaXB0aW9uX19tb3JlJykuc2hvdygpO1xuXHR9KTtcblxuXHQkKCcuYnRuX2luLWNhcnQnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHQkKHRoaXMpLmFkZENsYXNzKCdidG5faW4tY2FydC1hZGQnKTtcblx0fSk7XG5cblx0JCgnW2RhdGEtY2xvc2VdJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5wYXJlbnQoKS5oaWRlKCk7XG5cdFx0JCh0aGlzKS5jbG9zZXN0KCcuY2FyZCcpLmNzcygnei1pbmRleCcsICcnKTtcblx0fSk7XG5cblx0JCgnLnRpcF9fbmFtZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdCQoJy5jYXJkJykuY3NzKCd6LWluZGV4JywgJycpO1xuXHRcdCQoJy50aXBfX2hpZGVjb250ZW50JykuaGlkZSgpO1xuXHRcdCQodGhpcykucGFyZW50KCkuZmluZCgnLnRpcF9faGlkZWNvbnRlbnQnKS5zaG93KCk7XG5cdFx0JCh0aGlzKS5jbG9zZXN0KCcuY2FyZCcpLmNzcygnei1pbmRleCcsICcyJyk7XG5cdH0pO1xuXG5cdHZhciBkYXRhU2xpZGVycyA9IHtcblx0XHRmZWF1dHVyZXM6IHtcblx0XHRcdGl0ZW1zOiA2LFxuXHRcdFx0bmF2OiB0cnVlXG5cdFx0fSxcblx0XHRnYWxsZXJ5OiB7XG5cdFx0XHRpdGVtczogNCxcblx0XHRcdG5hdjogdHJ1ZSxcblx0XHRcdG1vdXNlRHJhZzogZmFsc2Vcblx0XHR9XG5cdH1cblxuXHQkKCdbZGF0YS1zbGlkZXJdJykuZWFjaChmdW5jdGlvbihpLCBzbGlkZXIpIHtcblx0XHR2YXIgZGF0YSA9ICQodGhpcykuZGF0YSgnc2xpZGVyJyk7XG5cblx0XHQkKHNsaWRlcikub3dsQ2Fyb3VzZWwoZGF0YVNsaWRlcnNbZGF0YV0pXG5cdH0pO1xuXG5cdC8vIEdhbGxlcnlcblx0JCgnLmdhbGxlcnlfX2VsZW1lbnQnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblxuXG5cdFx0aWYgKCQodGhpcykuaGFzQ2xhc3MoJ2dhbGxlcnlfX2VsZW1lbnRfdmlkZW8nKSkge1xuXHRcdFx0dmFyIHZpZGVvID0gJCh0aGlzKS5maW5kKCd2aWRlbycpLmNsb25lKCk7XG5cblx0XHRcdCQoJy5tb2RhbF96b29tIC5tb2RhbF9fY29udGVudCcpLmh0bWwodmlkZW8pO1xuXG5cdFx0XHQkKCcubW9kYWxfem9vbScpLml6aU1vZGFsKCdvcGVuJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBpbWcgPSAkKHRoaXMpLmZpbmQoJ2ltZycpLmNsb25lKCk7XG5cblx0XHRcdCQodGhpcykuY2xvc2VzdCgnLmdhbGxlcnknKS5maW5kKCcuZ2FsbGVyeV9fdmlldycpLmVtcHR5KCkuYXBwZW5kKGltZyk7XG5cblx0XHRcdCQodGhpcykuY2xvc2VzdCgnLmdhbGxlcnlfX2xpc3QnKS5maW5kKCcuZ2FsbGVyeV9fZWxlbWVudF9hY3RpdmUnKS5yZW1vdmVDbGFzcygnZ2FsbGVyeV9fZWxlbWVudF9hY3RpdmUnKTtcblx0XHRcdCQodGhpcykuYWRkQ2xhc3MoJ2dhbGxlcnlfX2VsZW1lbnRfYWN0aXZlJyk7XG5cdFx0fVxuXG5cblx0fSk7XG5cblx0JCgnLnZsaXN0X19tb3JlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5jbG9zZXN0KCcudmxpc3QnKS50b2dnbGVDbGFzcygndmxpc3RfYWxsc2hvdycpO1xuXHR9KTtcblxuXHQkKCdbZGF0YS1tb2RhbF0nKS5pemlNb2RhbCh7XG5cdFx0d2lkdGg6IDExODBcblx0fSk7XG5cblx0JCgnLmdhbGxlcnlfX3ZpZXcnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgaW1nID0gJCh0aGlzKS5maW5kKCdpbWcnKS5jbG9uZSgpO1xuXG5cdFx0JCgnLm1vZGFsX3pvb20gLm1vZGFsX19jb250ZW50JykuaHRtbChpbWcpXG5cblx0XHQkKCcubW9kYWxfem9vbScpLml6aU1vZGFsKCdvcGVuJyk7XG5cdH0pO1xuXG5cdGluaXQoKTtcblxufSkod2luZG93KTtcbiJdfQ==
