'use strict';

(function (root) {

	$('.range__slider').each(function () {
		var range = this,
		    minInput = $(range).closest('.range').find('[data-input="min"]'),
		    maxInput = $(range).closest('.range').find('[data-input="max"]');

		function update() {
			var from = $(range).data('from'),
			    to = $(range).data('to');

			$(minInput).val(from);
			$(maxInput).val(to);
		}

		$(range).ionRangeSlider({
			extra_classes: 'range__slider',
			hide_min_max: true,
			hide_from_to: true
		});

		update();
		$(range).on('change', update);
	});

	$('[data-input]').on('change', function () {
		var range = $(this).closest('.range').find('input.range__slider').data("ionRangeSlider"),
		    val = $(this).val(),
		    min = range.options.min,
		    max = range.options.max,
		    from = range.options.from,
		    to = range.options.to,
		    step = range.options.step;

		console.log(range.options);

		switch ($(this).data('input')) {
			case 'min':
				if (val <= min) {
					val = min;
				} else if (val >= max) {
					val = max - step;
				} else if (val >= to) {
					val = to - step;
				}

				range.update({
					from: val
				});
				break;
			case 'max':
				if (val >= max) {
					val = max;
				} else if (val <= min) {
					val = min + step;
				} else if (val <= from) {
					val = from + step;
				}

				range.update({
					to: val
				});
				break;
		}

		$(this).val(val);
	});

	function filled(field) {
		var val = $(field).val().trim();

		if (val.length > 0) {
			$(field).closest('.field').addClass('field_filled');
		} else {
			$(field).closest('.field').removeClass('field_filled');
		}
	}

	$('.field input').each(function () {
		filled(this);
	});

	$('.toggle').on('click', function (e) {
		e.stopPropagation();
		var content = $(this).parent().find($('.' + $(this).data('toggle')));
		$(this).toggleClass('toggle_close');
		$(content).stop().slideToggle(300);
	});

	$('.filter__block-content').each(function (i, block) {
		var checks = $(block).find('.checkbox').length;

		if (checks > 5) {
			$(block).addClass('filter__block-content_more');
			$(block).append('<span class="filter__block-more">Показать все</span>');
		}
	});

	$('.filter__block-more').on('click', function () {
		$(this).parent().removeClass('filter__block-content_more');
		$(this).remove();
	});

	$('.drop__item').on('click', function () {
		if (!$(this).hasClass('drop__item_link')) {
			$(this).addClass('drop__item_active').siblings().removeClass('drop__item_active');
		}

		$(this).closest('[data-drop]').removeClass('drop-open');
	});

	$(document).on('click', '[data-drop]', function () {

		var data = $(this).data('drop');

		if (data == 'trigger') {
			$('.drop-open').removeClass('drop-open');
			$(this).parent().closest('[data-drop]').addClass('drop-open');
		} else return;
	});

	$(document).on('click', function (e) {

		var drop = $(e.target).parent().closest('[data-drop]').get(0);

		if (!drop) {
			$('.drop-open').removeClass('drop-open');
		}
	});

	$('.description__show').on('click', function () {
		$(this).hide();
		$('.description__more').show();
	});
})(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJyb290IiwiJCIsImVhY2giLCJyYW5nZSIsIm1pbklucHV0IiwiY2xvc2VzdCIsImZpbmQiLCJtYXhJbnB1dCIsInVwZGF0ZSIsImZyb20iLCJkYXRhIiwidG8iLCJ2YWwiLCJpb25SYW5nZVNsaWRlciIsImV4dHJhX2NsYXNzZXMiLCJoaWRlX21pbl9tYXgiLCJoaWRlX2Zyb21fdG8iLCJvbiIsIm1pbiIsIm9wdGlvbnMiLCJtYXgiLCJzdGVwIiwiY29uc29sZSIsImxvZyIsImZpbGxlZCIsImZpZWxkIiwidHJpbSIsImxlbmd0aCIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwiY29udGVudCIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwic3RvcCIsInNsaWRlVG9nZ2xlIiwiaSIsImJsb2NrIiwiY2hlY2tzIiwiYXBwZW5kIiwicmVtb3ZlIiwiaGFzQ2xhc3MiLCJzaWJsaW5ncyIsImRvY3VtZW50IiwiZHJvcCIsInRhcmdldCIsImdldCIsImhpZGUiLCJzaG93Iiwid2luZG93Il0sIm1hcHBpbmdzIjoiOztBQUFBLENBQUMsVUFBU0EsSUFBVCxFQUFlOztBQUVmQyxHQUFFLGdCQUFGLEVBQW9CQyxJQUFwQixDQUF5QixZQUFXO0FBQ25DLE1BQUlDLFFBQVEsSUFBWjtBQUFBLE1BQ0VDLFdBQVdILEVBQUVFLEtBQUYsRUFBU0UsT0FBVCxDQUFpQixRQUFqQixFQUEyQkMsSUFBM0IsQ0FBZ0Msb0JBQWhDLENBRGI7QUFBQSxNQUVFQyxXQUFXTixFQUFFRSxLQUFGLEVBQVNFLE9BQVQsQ0FBaUIsUUFBakIsRUFBMkJDLElBQTNCLENBQWdDLG9CQUFoQyxDQUZiOztBQUlBLFdBQVNFLE1BQVQsR0FBa0I7QUFDakIsT0FBSUMsT0FBT1IsRUFBRUUsS0FBRixFQUFTTyxJQUFULENBQWMsTUFBZCxDQUFYO0FBQUEsT0FDRUMsS0FBS1YsRUFBRUUsS0FBRixFQUFTTyxJQUFULENBQWMsSUFBZCxDQURQOztBQUdBVCxLQUFFRyxRQUFGLEVBQVlRLEdBQVosQ0FBZ0JILElBQWhCO0FBQ0FSLEtBQUVNLFFBQUYsRUFBWUssR0FBWixDQUFnQkQsRUFBaEI7QUFDQTs7QUFFRFYsSUFBRUUsS0FBRixFQUFTVSxjQUFULENBQXdCO0FBQ3ZCQyxrQkFBZSxlQURRO0FBRXZCQyxpQkFBYyxJQUZTO0FBR3ZCQyxpQkFBYztBQUhTLEdBQXhCOztBQU1BUjtBQUNBUCxJQUFFRSxLQUFGLEVBQVNjLEVBQVQsQ0FBWSxRQUFaLEVBQXNCVCxNQUF0QjtBQUNBLEVBckJEOztBQXVCQVAsR0FBRSxjQUFGLEVBQWtCZ0IsRUFBbEIsQ0FBcUIsUUFBckIsRUFBK0IsWUFBVztBQUN6QyxNQUFJZCxRQUFRRixFQUFFLElBQUYsRUFBUUksT0FBUixDQUFnQixRQUFoQixFQUEwQkMsSUFBMUIsQ0FBK0IscUJBQS9CLEVBQXNESSxJQUF0RCxDQUEyRCxnQkFBM0QsQ0FBWjtBQUFBLE1BQ0VFLE1BQU1YLEVBQUUsSUFBRixFQUFRVyxHQUFSLEVBRFI7QUFBQSxNQUVFTSxNQUFNZixNQUFNZ0IsT0FBTixDQUFjRCxHQUZ0QjtBQUFBLE1BR0VFLE1BQU1qQixNQUFNZ0IsT0FBTixDQUFjQyxHQUh0QjtBQUFBLE1BSUVYLE9BQU9OLE1BQU1nQixPQUFOLENBQWNWLElBSnZCO0FBQUEsTUFLRUUsS0FBS1IsTUFBTWdCLE9BQU4sQ0FBY1IsRUFMckI7QUFBQSxNQU1FVSxPQUFPbEIsTUFBTWdCLE9BQU4sQ0FBY0UsSUFOdkI7O0FBUUFDLFVBQVFDLEdBQVIsQ0FBWXBCLE1BQU1nQixPQUFsQjs7QUFFQSxVQUFRbEIsRUFBRSxJQUFGLEVBQVFTLElBQVIsQ0FBYSxPQUFiLENBQVI7QUFDQyxRQUFLLEtBQUw7QUFDQyxRQUFJRSxPQUFPTSxHQUFYLEVBQWdCO0FBQ2ZOLFdBQU1NLEdBQU47QUFDQSxLQUZELE1BRU8sSUFBSU4sT0FBT1EsR0FBWCxFQUFnQjtBQUN0QlIsV0FBTVEsTUFBTUMsSUFBWjtBQUNBLEtBRk0sTUFFQSxJQUFJVCxPQUFPRCxFQUFYLEVBQWU7QUFDckJDLFdBQU1ELEtBQUtVLElBQVg7QUFDQTs7QUFFRGxCLFVBQU1LLE1BQU4sQ0FBYTtBQUNaQyxXQUFNRztBQURNLEtBQWI7QUFHQTtBQUNELFFBQUssS0FBTDtBQUNDLFFBQUlBLE9BQU9RLEdBQVgsRUFBZ0I7QUFDZlIsV0FBTVEsR0FBTjtBQUNBLEtBRkQsTUFFTyxJQUFJUixPQUFPTSxHQUFYLEVBQWdCO0FBQ3RCTixXQUFNTSxNQUFNRyxJQUFaO0FBQ0EsS0FGTSxNQUVBLElBQUlULE9BQU9ILElBQVgsRUFBaUI7QUFDdkJHLFdBQU1ILE9BQU9ZLElBQWI7QUFDQTs7QUFFRGxCLFVBQU1LLE1BQU4sQ0FBYTtBQUNaRyxTQUFJQztBQURRLEtBQWI7QUFHQTtBQTFCRjs7QUE2QkFYLElBQUUsSUFBRixFQUFRVyxHQUFSLENBQVlBLEdBQVo7QUFFQSxFQTFDRDs7QUE0Q0EsVUFBU1ksTUFBVCxDQUFnQkMsS0FBaEIsRUFBdUI7QUFDdEIsTUFBSWIsTUFBTVgsRUFBRXdCLEtBQUYsRUFBU2IsR0FBVCxHQUFlYyxJQUFmLEVBQVY7O0FBRUEsTUFBSWQsSUFBSWUsTUFBSixHQUFhLENBQWpCLEVBQW9CO0FBQ25CMUIsS0FBRXdCLEtBQUYsRUFBU3BCLE9BQVQsQ0FBaUIsUUFBakIsRUFBMkJ1QixRQUEzQixDQUFvQyxjQUFwQztBQUNBLEdBRkQsTUFFTztBQUNOM0IsS0FBRXdCLEtBQUYsRUFBU3BCLE9BQVQsQ0FBaUIsUUFBakIsRUFBMkJ3QixXQUEzQixDQUF1QyxjQUF2QztBQUNBO0FBQ0Q7O0FBRUQ1QixHQUFFLGNBQUYsRUFBa0JDLElBQWxCLENBQXVCLFlBQVc7QUFDakNzQixTQUFPLElBQVA7QUFDQSxFQUZEOztBQUlBdkIsR0FBRSxTQUFGLEVBQWFnQixFQUFiLENBQWdCLE9BQWhCLEVBQXlCLFVBQVNhLENBQVQsRUFBWTtBQUNwQ0EsSUFBRUMsZUFBRjtBQUNBLE1BQUlDLFVBQVUvQixFQUFFLElBQUYsRUFBUWdDLE1BQVIsR0FBaUIzQixJQUFqQixDQUFzQkwsRUFBRSxNQUFJQSxFQUFFLElBQUYsRUFBUVMsSUFBUixDQUFhLFFBQWIsQ0FBTixDQUF0QixDQUFkO0FBQ0FULElBQUUsSUFBRixFQUFRaUMsV0FBUixDQUFvQixjQUFwQjtBQUNBakMsSUFBRStCLE9BQUYsRUFBV0csSUFBWCxHQUFrQkMsV0FBbEIsQ0FBOEIsR0FBOUI7QUFDQSxFQUxEOztBQU9BbkMsR0FBRSx3QkFBRixFQUE0QkMsSUFBNUIsQ0FBaUMsVUFBU21DLENBQVQsRUFBWUMsS0FBWixFQUFtQjtBQUNuRCxNQUFJQyxTQUFTdEMsRUFBRXFDLEtBQUYsRUFBU2hDLElBQVQsQ0FBYyxXQUFkLEVBQTJCcUIsTUFBeEM7O0FBRUEsTUFBSVksU0FBUyxDQUFiLEVBQWdCO0FBQ2Z0QyxLQUFFcUMsS0FBRixFQUFTVixRQUFULENBQWtCLDRCQUFsQjtBQUNBM0IsS0FBRXFDLEtBQUYsRUFBU0UsTUFBVCxDQUFnQixzREFBaEI7QUFDQTtBQUNELEVBUEQ7O0FBU0F2QyxHQUFFLHFCQUFGLEVBQXlCZ0IsRUFBekIsQ0FBNEIsT0FBNUIsRUFBcUMsWUFBVztBQUMvQ2hCLElBQUUsSUFBRixFQUFRZ0MsTUFBUixHQUFpQkosV0FBakIsQ0FBNkIsNEJBQTdCO0FBQ0E1QixJQUFFLElBQUYsRUFBUXdDLE1BQVI7QUFDQSxFQUhEOztBQUtBeEMsR0FBRSxhQUFGLEVBQWlCZ0IsRUFBakIsQ0FBb0IsT0FBcEIsRUFBNkIsWUFBVztBQUN2QyxNQUFJLENBQUNoQixFQUFFLElBQUYsRUFBUXlDLFFBQVIsQ0FBaUIsaUJBQWpCLENBQUwsRUFBMEM7QUFDekN6QyxLQUFFLElBQUYsRUFBUTJCLFFBQVIsQ0FBaUIsbUJBQWpCLEVBQXNDZSxRQUF0QyxHQUFpRGQsV0FBakQsQ0FBNkQsbUJBQTdEO0FBQ0E7O0FBRUQ1QixJQUFFLElBQUYsRUFBUUksT0FBUixDQUFnQixhQUFoQixFQUErQndCLFdBQS9CLENBQTJDLFdBQTNDO0FBQ0EsRUFORDs7QUFRQTVCLEdBQUUyQyxRQUFGLEVBQVkzQixFQUFaLENBQWUsT0FBZixFQUF3QixhQUF4QixFQUF1QyxZQUFXOztBQUVqRCxNQUFJUCxPQUFPVCxFQUFFLElBQUYsRUFBUVMsSUFBUixDQUFhLE1BQWIsQ0FBWDs7QUFFQSxNQUFJQSxRQUFRLFNBQVosRUFBdUI7QUFDdEJULEtBQUUsWUFBRixFQUFnQjRCLFdBQWhCLENBQTRCLFdBQTVCO0FBQ0E1QixLQUFFLElBQUYsRUFBUWdDLE1BQVIsR0FBaUI1QixPQUFqQixDQUF5QixhQUF6QixFQUF3Q3VCLFFBQXhDLENBQWlELFdBQWpEO0FBQ0EsR0FIRCxNQUdPO0FBRVAsRUFURDs7QUFXQTNCLEdBQUUyQyxRQUFGLEVBQVkzQixFQUFaLENBQWUsT0FBZixFQUF3QixVQUFTYSxDQUFULEVBQVk7O0FBRW5DLE1BQUllLE9BQU81QyxFQUFFNkIsRUFBRWdCLE1BQUosRUFBWWIsTUFBWixHQUFxQjVCLE9BQXJCLENBQTZCLGFBQTdCLEVBQTRDMEMsR0FBNUMsQ0FBZ0QsQ0FBaEQsQ0FBWDs7QUFFQSxNQUFJLENBQUNGLElBQUwsRUFBVztBQUNWNUMsS0FBRSxZQUFGLEVBQWdCNEIsV0FBaEIsQ0FBNEIsV0FBNUI7QUFDQTtBQUVELEVBUkQ7O0FBVUE1QixHQUFFLG9CQUFGLEVBQXdCZ0IsRUFBeEIsQ0FBMkIsT0FBM0IsRUFBb0MsWUFBVztBQUM5Q2hCLElBQUUsSUFBRixFQUFRK0MsSUFBUjtBQUNBL0MsSUFBRSxvQkFBRixFQUF3QmdELElBQXhCO0FBQ0EsRUFIRDtBQUtBLENBMUlELEVBMElHQyxNQTFJSCIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24ocm9vdCkge1xuXG5cdCQoJy5yYW5nZV9fc2xpZGVyJykuZWFjaChmdW5jdGlvbigpIHtcblx0XHR2YXIgcmFuZ2UgPSB0aGlzLFxuXHRcdFx0XHRtaW5JbnB1dCA9ICQocmFuZ2UpLmNsb3Nlc3QoJy5yYW5nZScpLmZpbmQoJ1tkYXRhLWlucHV0PVwibWluXCJdJyksXG5cdFx0XHRcdG1heElucHV0ID0gJChyYW5nZSkuY2xvc2VzdCgnLnJhbmdlJykuZmluZCgnW2RhdGEtaW5wdXQ9XCJtYXhcIl0nKTtcblxuXHRcdGZ1bmN0aW9uIHVwZGF0ZSgpIHtcblx0XHRcdHZhciBmcm9tID0gJChyYW5nZSkuZGF0YSgnZnJvbScpLFxuXHRcdFx0XHRcdHRvID0gJChyYW5nZSkuZGF0YSgndG8nKTtcblxuXHRcdFx0JChtaW5JbnB1dCkudmFsKGZyb20pO1xuXHRcdFx0JChtYXhJbnB1dCkudmFsKHRvKTtcblx0XHR9XG5cblx0XHQkKHJhbmdlKS5pb25SYW5nZVNsaWRlcih7XG5cdFx0XHRleHRyYV9jbGFzc2VzOiAncmFuZ2VfX3NsaWRlcicsXG5cdFx0XHRoaWRlX21pbl9tYXg6IHRydWUsXG5cdFx0XHRoaWRlX2Zyb21fdG86IHRydWUsXG5cdFx0fSk7XG5cblx0XHR1cGRhdGUoKTtcblx0XHQkKHJhbmdlKS5vbignY2hhbmdlJywgdXBkYXRlKTtcblx0fSk7XG5cblx0JCgnW2RhdGEtaW5wdXRdJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuXHRcdHZhciByYW5nZSA9ICQodGhpcykuY2xvc2VzdCgnLnJhbmdlJykuZmluZCgnaW5wdXQucmFuZ2VfX3NsaWRlcicpLmRhdGEoXCJpb25SYW5nZVNsaWRlclwiKSxcblx0XHRcdFx0dmFsID0gJCh0aGlzKS52YWwoKSxcblx0XHRcdFx0bWluID0gcmFuZ2Uub3B0aW9ucy5taW4sXG5cdFx0XHRcdG1heCA9IHJhbmdlLm9wdGlvbnMubWF4LFxuXHRcdFx0XHRmcm9tID0gcmFuZ2Uub3B0aW9ucy5mcm9tLFxuXHRcdFx0XHR0byA9IHJhbmdlLm9wdGlvbnMudG8sXG5cdFx0XHRcdHN0ZXAgPSByYW5nZS5vcHRpb25zLnN0ZXA7XG5cblx0XHRjb25zb2xlLmxvZyhyYW5nZS5vcHRpb25zKVxuXG5cdFx0c3dpdGNoICgkKHRoaXMpLmRhdGEoJ2lucHV0JykpIHtcblx0XHRcdGNhc2UgJ21pbic6XG5cdFx0XHRcdGlmICh2YWwgPD0gbWluKSB7XG5cdFx0XHRcdFx0dmFsID0gbWluO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHZhbCA+PSBtYXgpIHtcblx0XHRcdFx0XHR2YWwgPSBtYXggLSBzdGVwO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHZhbCA+PSB0bykge1xuXHRcdFx0XHRcdHZhbCA9IHRvIC0gc3RlcDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJhbmdlLnVwZGF0ZSh7XG5cdFx0XHRcdFx0ZnJvbTogdmFsXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ21heCc6XG5cdFx0XHRcdGlmICh2YWwgPj0gbWF4KSB7XG5cdFx0XHRcdFx0dmFsID0gbWF4O1xuXHRcdFx0XHR9IGVsc2UgaWYgKHZhbCA8PSBtaW4pIHtcblx0XHRcdFx0XHR2YWwgPSBtaW4gKyBzdGVwO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHZhbCA8PSBmcm9tKSB7XG5cdFx0XHRcdFx0dmFsID0gZnJvbSArIHN0ZXA7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyYW5nZS51cGRhdGUoe1xuXHRcdFx0XHRcdHRvOiB2YWxcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdCQodGhpcykudmFsKHZhbCk7XG5cblx0fSk7XG5cblx0ZnVuY3Rpb24gZmlsbGVkKGZpZWxkKSB7XG5cdFx0dmFyIHZhbCA9ICQoZmllbGQpLnZhbCgpLnRyaW0oKTtcblxuXHRcdGlmICh2YWwubGVuZ3RoID4gMCkge1xuXHRcdFx0JChmaWVsZCkuY2xvc2VzdCgnLmZpZWxkJykuYWRkQ2xhc3MoJ2ZpZWxkX2ZpbGxlZCcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQkKGZpZWxkKS5jbG9zZXN0KCcuZmllbGQnKS5yZW1vdmVDbGFzcygnZmllbGRfZmlsbGVkJyk7XG5cdFx0fVxuXHR9XG5cblx0JCgnLmZpZWxkIGlucHV0JykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRmaWxsZWQodGhpcyk7XG5cdH0pO1xuXG5cdCQoJy50b2dnbGUnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKVxuXHRcdHZhciBjb250ZW50ID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCQoJy4nKyQodGhpcykuZGF0YSgndG9nZ2xlJykpKTtcblx0XHQkKHRoaXMpLnRvZ2dsZUNsYXNzKCd0b2dnbGVfY2xvc2UnKTtcblx0XHQkKGNvbnRlbnQpLnN0b3AoKS5zbGlkZVRvZ2dsZSgzMDApO1xuXHR9KTtcblxuXHQkKCcuZmlsdGVyX19ibG9jay1jb250ZW50JykuZWFjaChmdW5jdGlvbihpLCBibG9jaykge1xuXHRcdHZhciBjaGVja3MgPSAkKGJsb2NrKS5maW5kKCcuY2hlY2tib3gnKS5sZW5ndGg7XG5cblx0XHRpZiAoY2hlY2tzID4gNSkge1xuXHRcdFx0JChibG9jaykuYWRkQ2xhc3MoJ2ZpbHRlcl9fYmxvY2stY29udGVudF9tb3JlJyk7XG5cdFx0XHQkKGJsb2NrKS5hcHBlbmQoJzxzcGFuIGNsYXNzPVwiZmlsdGVyX19ibG9jay1tb3JlXCI+0J/QvtC60LDQt9Cw0YLRjCDQstGB0LU8L3NwYW4+Jyk7XG5cdFx0fVxuXHR9KTtcblxuXHQkKCcuZmlsdGVyX19ibG9jay1tb3JlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnZmlsdGVyX19ibG9jay1jb250ZW50X21vcmUnKTtcblx0XHQkKHRoaXMpLnJlbW92ZSgpO1xuXHR9KTtcblxuXHQkKCcuZHJvcF9faXRlbScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdGlmICghJCh0aGlzKS5oYXNDbGFzcygnZHJvcF9faXRlbV9saW5rJykpIHtcblx0XHRcdCQodGhpcykuYWRkQ2xhc3MoJ2Ryb3BfX2l0ZW1fYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnZHJvcF9faXRlbV9hY3RpdmUnKTtcblx0XHR9XG5cblx0XHQkKHRoaXMpLmNsb3Nlc3QoJ1tkYXRhLWRyb3BdJykucmVtb3ZlQ2xhc3MoJ2Ryb3Atb3BlbicpO1xuXHR9KTtcblxuXHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnW2RhdGEtZHJvcF0nLCBmdW5jdGlvbigpIHtcblxuXHRcdHZhciBkYXRhID0gJCh0aGlzKS5kYXRhKCdkcm9wJyk7XG5cblx0XHRpZiAoZGF0YSA9PSAndHJpZ2dlcicpIHtcblx0XHRcdCQoJy5kcm9wLW9wZW4nKS5yZW1vdmVDbGFzcygnZHJvcC1vcGVuJyk7XG5cdFx0XHQkKHRoaXMpLnBhcmVudCgpLmNsb3Nlc3QoJ1tkYXRhLWRyb3BdJykuYWRkQ2xhc3MoJ2Ryb3Atb3BlbicpO1xuXHRcdH0gZWxzZSByZXR1cm47XG5cblx0fSk7XG5cblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXG5cdFx0dmFyIGRyb3AgPSAkKGUudGFyZ2V0KS5wYXJlbnQoKS5jbG9zZXN0KCdbZGF0YS1kcm9wXScpLmdldCgwKTtcblxuXHRcdGlmICghZHJvcCkge1xuXHRcdFx0JCgnLmRyb3Atb3BlbicpLnJlbW92ZUNsYXNzKCdkcm9wLW9wZW4nKTtcblx0XHR9XG5cblx0fSlcblxuXHQkKCcuZGVzY3JpcHRpb25fX3Nob3cnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHQkKHRoaXMpLmhpZGUoKTtcblx0XHQkKCcuZGVzY3JpcHRpb25fX21vcmUnKS5zaG93KCk7XG5cdH0pO1xuXG59KSh3aW5kb3cpO1xuIl19
