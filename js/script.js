'use strict';

(function (root) {

	function init() {
		$('.gallery__element').first().trigger('click');
	};

	$('.range__slider').each(function () {
		var range = this,
		    minInput = $(range).closest('.range').find('[data-input="min"]'),
		    maxInput = $(range).closest('.range').find('[data-input="max"]');

		function update() {
			var from = $(range).data('from'),
			    to = $(range).data('to');

			$(minInput).val(from);
			$(maxInput).val(to);
		}

		$(range).ionRangeSlider({
			extra_classes: 'range__slider',
			hide_min_max: true,
			hide_from_to: true
		});

		update();
		$(range).on('change', update);
	});

	$('[data-input]').on('change', function () {
		var range = $(this).closest('.range').find('input.range__slider').data("ionRangeSlider"),
		    val = $(this).val(),
		    min = range.options.min,
		    max = range.options.max,
		    from = range.options.from,
		    to = range.options.to,
		    step = range.options.step;

		switch ($(this).data('input')) {
			case 'min':
				if (val <= min) {
					val = min;
				} else if (val >= max) {
					val = max - step;
				} else if (val >= to) {
					val = to - step;
				}

				range.update({
					from: val
				});
				break;
			case 'max':
				if (val >= max) {
					val = max;
				} else if (val <= min) {
					val = min + step;
				} else if (val <= from) {
					val = from + step;
				}

				range.update({
					to: val
				});
				break;
		}

		$(this).val(val);
	});

	function filled(field) {
		var val = $(field).val().trim();

		if (val.length > 0) {
			$(field).closest('.field').addClass('field_filled');
		} else {
			$(field).closest('.field').removeClass('field_filled');
		}
	}

	$('.field input').each(function () {
		filled(this);
	});

	$('.toggle').on('click', function (e) {
		e.stopPropagation();
		var content = $(this).parent().find($('.' + $(this).data('toggle')));
		$(this).toggleClass('toggle_close');
		$(content).stop().slideToggle(300);
	});

	$('.filter__block-content').each(function (i, block) {
		var checks = $(block).find('.checkbox').length;

		if (checks > 5) {
			$(block).addClass('filter__block-content_more');
			$(block).append('<span class="filter__block-more">Показать все</span>');
		}
	});

	$('.filter__block-more').on('click', function () {
		$(this).parent().removeClass('filter__block-content_more');
		$(this).remove();
	});

	$('.drop__item').on('click', function () {
		if (!$(this).hasClass('drop__item_link')) {
			$(this).addClass('drop__item_active').siblings().removeClass('drop__item_active');
		}

		$(this).closest('[data-drop]').removeClass('drop-open');
	});

	$(document).on('click', '[data-drop]', function () {

		var data = $(this).data('drop');

		if (data == 'trigger') {
			$('.drop-open').removeClass('drop-open');
			$(this).parent().closest('[data-drop]').addClass('drop-open');
		} else return;
	});

	$(document).on('click', function (e) {

		var drop = $(e.target).parent().closest('[data-drop]').get(0),
		    tip = $(e.target).parent().closest('.tip').get(0);

		if (!drop) {
			$('.drop-open').removeClass('drop-open');
		}

		if (!tip) {
			$('.tip__hidecontent').hide();
		}
	});

	$('.description__show').on('click', function () {
		$(this).hide();
		$('.description__more').show();
	});

	$('.btn_in-cart').on('click', function () {
		$(this).addClass('btn_in-cart-add');
	});

	$('[data-close]').on('click', function () {
		$(this).parent().hide();
		$(this).closest('.card').css('z-index', '');
	});

	$('.tip__name').on('click', function () {
		$('.card').css('z-index', '');
		$('.tip__hidecontent').hide();
		$(this).parent().find('.tip__hidecontent').show();
		$(this).closest('.card').css('z-index', '2');
	});

	var dataSliders = {
		feautures: {
			items: 6,
			nav: true
		},
		gallery: {
			items: 4,
			nav: true,
			mouseDrag: false
		}
	};

	$('[data-slider]').each(function (i, slider) {
		var data = $(this).data('slider');

		$(slider).owlCarousel(dataSliders[data]);
	});

	// Gallery
	$('.gallery__element').on('click', function () {
		$(this).closest('.gallery__list').find('.gallery__element_active').removeClass('gallery__element_active');
		$(this).addClass('gallery__element_active');

		if ($(this).hasClass('gallery__element_video')) {
			console.log('video');
		} else {
			var img = $(this).find('img').clone();

			$(this).closest('.gallery').find('.gallery__view').empty().append(img);
		}
	});

	init();
})(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJyb290IiwiaW5pdCIsIiQiLCJmaXJzdCIsInRyaWdnZXIiLCJlYWNoIiwicmFuZ2UiLCJtaW5JbnB1dCIsImNsb3Nlc3QiLCJmaW5kIiwibWF4SW5wdXQiLCJ1cGRhdGUiLCJmcm9tIiwiZGF0YSIsInRvIiwidmFsIiwiaW9uUmFuZ2VTbGlkZXIiLCJleHRyYV9jbGFzc2VzIiwiaGlkZV9taW5fbWF4IiwiaGlkZV9mcm9tX3RvIiwib24iLCJtaW4iLCJvcHRpb25zIiwibWF4Iiwic3RlcCIsImZpbGxlZCIsImZpZWxkIiwidHJpbSIsImxlbmd0aCIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwiY29udGVudCIsInBhcmVudCIsInRvZ2dsZUNsYXNzIiwic3RvcCIsInNsaWRlVG9nZ2xlIiwiaSIsImJsb2NrIiwiY2hlY2tzIiwiYXBwZW5kIiwicmVtb3ZlIiwiaGFzQ2xhc3MiLCJzaWJsaW5ncyIsImRvY3VtZW50IiwiZHJvcCIsInRhcmdldCIsImdldCIsInRpcCIsImhpZGUiLCJzaG93IiwiY3NzIiwiZGF0YVNsaWRlcnMiLCJmZWF1dHVyZXMiLCJpdGVtcyIsIm5hdiIsImdhbGxlcnkiLCJtb3VzZURyYWciLCJzbGlkZXIiLCJvd2xDYXJvdXNlbCIsImNvbnNvbGUiLCJsb2ciLCJpbWciLCJjbG9uZSIsImVtcHR5Iiwid2luZG93Il0sIm1hcHBpbmdzIjoiOztBQUFBLENBQUMsVUFBU0EsSUFBVCxFQUFlOztBQUVmLFVBQVNDLElBQVQsR0FBZ0I7QUFDZkMsSUFBRSxtQkFBRixFQUF1QkMsS0FBdkIsR0FBK0JDLE9BQS9CLENBQXVDLE9BQXZDO0FBQ0E7O0FBRURGLEdBQUUsZ0JBQUYsRUFBb0JHLElBQXBCLENBQXlCLFlBQVc7QUFDbkMsTUFBSUMsUUFBUSxJQUFaO0FBQUEsTUFDRUMsV0FBV0wsRUFBRUksS0FBRixFQUFTRSxPQUFULENBQWlCLFFBQWpCLEVBQTJCQyxJ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QUFvQjtBQUMzQyxNQUFJOUMsT0FBT1gsRUFBRSxJQUFGLEVBQVFXLElBQVIsQ0FBYSxRQUFiLENBQVg7O0FBRUFYLElBQUV5RCxNQUFGLEVBQVVDLFdBQVYsQ0FBc0JQLFlBQVl4QyxJQUFaLENBQXRCO0FBQ0EsRUFKRDs7QUFNQTtBQUNBWCxHQUFFLG1CQUFGLEVBQXVCa0IsRUFBdkIsQ0FBMEIsT0FBMUIsRUFBbUMsWUFBVztBQUM3Q2xCLElBQUUsSUFBRixFQUFRTSxPQUFSLENBQWdCLGdCQUFoQixFQUFrQ0MsSUFBbEMsQ0FBdUMsMEJBQXZDLEVBQW1FcUIsV0FBbkUsQ0FBK0UseUJBQS9FO0FBQ0E1QixJQUFFLElBQUYsRUFBUTJCLFFBQVIsQ0FBaUIseUJBQWpCOztBQUVBLE1BQUkzQixFQUFFLElBQUYsRUFBUXlDLFFBQVIsQ0FBaUIsd0JBQWpCLENBQUosRUFBZ0Q7QUFDL0NrQixXQUFRQyxHQUFSLENBQVksT0FBWjtBQUNBLEdBRkQsTUFFTztBQUNOLE9BQUlDLE1BQU03RCxFQUFFLElBQUYsRUFBUU8sSUFBUixDQUFhLEtBQWIsRUFBb0J1RCxLQUFwQixFQUFWOztBQUVBOUQsS0FBRSxJQUFGLEVBQVFNLE9BQVIsQ0FBZ0IsVUFBaEIsRUFBNEJDLElBQTVCLENBQWlDLGdCQUFqQyxFQUFtRHdELEtBQW5ELEdBQTJEeEIsTUFBM0QsQ0FBa0VzQixHQUFsRTtBQUNBO0FBR0QsRUFiRDs7QUFlQTlEO0FBRUEsQ0FyTUQsRUFxTUdpRSxNQXJNSCIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24ocm9vdCkge1xuXG5cdGZ1bmN0aW9uIGluaXQoKSB7XG5cdFx0JCgnLmdhbGxlcnlfX2VsZW1lbnQnKS5maXJzdCgpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdH07XG5cblx0JCgnLnJhbmdlX19zbGlkZXInKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdHZhciByYW5nZSA9IHRoaXMsXG5cdFx0XHRcdG1pbklucHV0ID0gJChyYW5nZSkuY2xvc2VzdCgnLnJhbmdlJykuZmluZCgnW2RhdGEtaW5wdXQ9XCJtaW5cIl0nKSxcblx0XHRcdFx0bWF4SW5wdXQgPSAkKHJhbmdlKS5jbG9zZXN0KCcucmFuZ2UnKS5maW5kKCdbZGF0YS1pbnB1dD1cIm1heFwiXScpO1xuXG5cdFx0ZnVuY3Rpb24gdXBkYXRlKCkge1xuXHRcdFx0dmFyIGZyb20gPSAkKHJhbmdlKS5kYXRhKCdmcm9tJyksXG5cdFx0XHRcdFx0dG8gPSAkKHJhbmdlKS5kYXRhKCd0bycpO1xuXG5cdFx0XHQkKG1pbklucHV0KS52YWwoZnJvbSk7XG5cdFx0XHQkKG1heElucHV0KS52YWwodG8pO1xuXHRcdH1cblxuXHRcdCQocmFuZ2UpLmlvblJhbmdlU2xpZGVyKHtcblx0XHRcdGV4dHJhX2NsYXNzZXM6ICdyYW5nZV9fc2xpZGVyJyxcblx0XHRcdGhpZGVfbWluX21heDogdHJ1ZSxcblx0XHRcdGhpZGVfZnJvbV90bzogdHJ1ZSxcblx0XHR9KTtcblxuXHRcdHVwZGF0ZSgpO1xuXHRcdCQocmFuZ2UpLm9uKCdjaGFuZ2UnLCB1cGRhdGUpO1xuXHR9KTtcblxuXHQkKCdbZGF0YS1pbnB1dF0nKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHJhbmdlID0gJCh0aGlzKS5jbG9zZXN0KCcucmFuZ2UnKS5maW5kKCdpbnB1dC5yYW5nZV9fc2xpZGVyJykuZGF0YShcImlvblJhbmdlU2xpZGVyXCIpLFxuXHRcdFx0XHR2YWwgPSAkKHRoaXMpLnZhbCgpLFxuXHRcdFx0XHRtaW4gPSByYW5nZS5vcHRpb25zLm1pbixcblx0XHRcdFx0bWF4ID0gcmFuZ2Uub3B0aW9ucy5tYXgsXG5cdFx0XHRcdGZyb20gPSByYW5nZS5vcHRpb25zLmZyb20sXG5cdFx0XHRcdHRvID0gcmFuZ2Uub3B0aW9ucy50byxcblx0XHRcdFx0c3RlcCA9IHJhbmdlLm9wdGlvbnMuc3RlcDtcblxuXHRcdHN3aXRjaCAoJCh0aGlzKS5kYXRhKCdpbnB1dCcpKSB7XG5cdFx0XHRjYXNlICdtaW4nOlxuXHRcdFx0XHRpZiAodmFsIDw9IG1pbikge1xuXHRcdFx0XHRcdHZhbCA9IG1pbjtcblx0XHRcdFx0fSBlbHNlIGlmICh2YWwgPj0gbWF4KSB7XG5cdFx0XHRcdFx0dmFsID0gbWF4IC0gc3RlcDtcblx0XHRcdFx0fSBlbHNlIGlmICh2YWwgPj0gdG8pIHtcblx0XHRcdFx0XHR2YWwgPSB0byAtIHN0ZXA7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyYW5nZS51cGRhdGUoe1xuXHRcdFx0XHRcdGZyb206IHZhbFxuXHRcdFx0XHR9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdtYXgnOlxuXHRcdFx0XHRpZiAodmFsID49IG1heCkge1xuXHRcdFx0XHRcdHZhbCA9IG1heDtcblx0XHRcdFx0fSBlbHNlIGlmICh2YWwgPD0gbWluKSB7XG5cdFx0XHRcdFx0dmFsID0gbWluICsgc3RlcDtcblx0XHRcdFx0fSBlbHNlIGlmICh2YWwgPD0gZnJvbSkge1xuXHRcdFx0XHRcdHZhbCA9IGZyb20gKyBzdGVwO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmFuZ2UudXBkYXRlKHtcblx0XHRcdFx0XHR0bzogdmFsXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cblx0XHQkKHRoaXMpLnZhbCh2YWwpO1xuXG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGZpbGxlZChmaWVsZCkge1xuXHRcdHZhciB2YWwgPSAkKGZpZWxkKS52YWwoKS50cmltKCk7XG5cblx0XHRpZiAodmFsLmxlbmd0aCA+IDApIHtcblx0XHRcdCQoZmllbGQpLmNsb3Nlc3QoJy5maWVsZCcpLmFkZENsYXNzKCdmaWVsZF9maWxsZWQnKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0JChmaWVsZCkuY2xvc2VzdCgnLmZpZWxkJykucmVtb3ZlQ2xhc3MoJ2ZpZWxkX2ZpbGxlZCcpO1xuXHRcdH1cblx0fVxuXG5cdCQoJy5maWVsZCBpbnB1dCcpLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0ZmlsbGVkKHRoaXMpO1xuXHR9KTtcblxuXHQkKCcudG9nZ2xlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKClcblx0XHR2YXIgY29udGVudCA9ICQodGhpcykucGFyZW50KCkuZmluZCgkKCcuJyskKHRoaXMpLmRhdGEoJ3RvZ2dsZScpKSk7XG5cdFx0JCh0aGlzKS50b2dnbGVDbGFzcygndG9nZ2xlX2Nsb3NlJyk7XG5cdFx0JChjb250ZW50KS5zdG9wKCkuc2xpZGVUb2dnbGUoMzAwKTtcblx0fSk7XG5cblx0JCgnLmZpbHRlcl9fYmxvY2stY29udGVudCcpLmVhY2goZnVuY3Rpb24oaSwgYmxvY2spIHtcblx0XHR2YXIgY2hlY2tzID0gJChibG9jaykuZmluZCgnLmNoZWNrYm94JykubGVuZ3RoO1xuXG5cdFx0aWYgKGNoZWNrcyA+IDUpIHtcblx0XHRcdCQoYmxvY2spLmFkZENsYXNzKCdmaWx0ZXJfX2Jsb2NrLWNvbnRlbnRfbW9yZScpO1xuXHRcdFx0JChibG9jaykuYXBwZW5kKCc8c3BhbiBjbGFzcz1cImZpbHRlcl9fYmxvY2stbW9yZVwiPtCf0L7QutCw0LfQsNGC0Ywg0LLRgdC1PC9zcGFuPicpO1xuXHRcdH1cblx0fSk7XG5cblx0JCgnLmZpbHRlcl9fYmxvY2stbW9yZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdCQodGhpcykucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ2ZpbHRlcl9fYmxvY2stY29udGVudF9tb3JlJyk7XG5cdFx0JCh0aGlzKS5yZW1vdmUoKTtcblx0fSk7XG5cblx0JCgnLmRyb3BfX2l0ZW0nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRpZiAoISQodGhpcykuaGFzQ2xhc3MoJ2Ryb3BfX2l0ZW1fbGluaycpKSB7XG5cdFx0XHQkKHRoaXMpLmFkZENsYXNzKCdkcm9wX19pdGVtX2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2Ryb3BfX2l0ZW1fYWN0aXZlJyk7XG5cdFx0fVxuXG5cdFx0JCh0aGlzKS5jbG9zZXN0KCdbZGF0YS1kcm9wXScpLnJlbW92ZUNsYXNzKCdkcm9wLW9wZW4nKTtcblx0fSk7XG5cblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgJ1tkYXRhLWRyb3BdJywgZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgZGF0YSA9ICQodGhpcykuZGF0YSgnZHJvcCcpO1xuXG5cdFx0aWYgKGRhdGEgPT0gJ3RyaWdnZXInKSB7XG5cdFx0XHQkKCcuZHJvcC1vcGVuJykucmVtb3ZlQ2xhc3MoJ2Ryb3Atb3BlbicpO1xuXHRcdFx0JCh0aGlzKS5wYXJlbnQoKS5jbG9zZXN0KCdbZGF0YS1kcm9wXScpLmFkZENsYXNzKCdkcm9wLW9wZW4nKTtcblx0XHR9IGVsc2UgcmV0dXJuO1xuXG5cdH0pO1xuXG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblxuXHRcdHZhciBkcm9wID0gJChlLnRhcmdldCkucGFyZW50KCkuY2xvc2VzdCgnW2RhdGEtZHJvcF0nKS5nZXQoMCksXG5cdFx0XHRcdHRpcCA9ICQoZS50YXJnZXQpLnBhcmVudCgpLmNsb3Nlc3QoJy50aXAnKS5nZXQoMCk7XG5cblx0XHRpZiAoIWRyb3ApIHtcblx0XHRcdCQoJy5kcm9wLW9wZW4nKS5yZW1vdmVDbGFzcygnZHJvcC1vcGVuJyk7XG5cdFx0fVxuXG5cdFx0aWYgKCF0aXApIHtcblx0XHRcdCQoJy50aXBfX2hpZGVjb250ZW50JykuaGlkZSgpO1xuXHRcdH1cblxuXHR9KVxuXG5cdCQoJy5kZXNjcmlwdGlvbl9fc2hvdycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdCQodGhpcykuaGlkZSgpO1xuXHRcdCQoJy5kZXNjcmlwdGlvbl9fbW9yZScpLnNob3coKTtcblx0fSk7XG5cblx0JCgnLmJ0bl9pbi1jYXJ0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5hZGRDbGFzcygnYnRuX2luLWNhcnQtYWRkJyk7XG5cdH0pO1xuXG5cdCQoJ1tkYXRhLWNsb3NlXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdCQodGhpcykucGFyZW50KCkuaGlkZSgpO1xuXHRcdCQodGhpcykuY2xvc2VzdCgnLmNhcmQnKS5jc3MoJ3otaW5kZXgnLCAnJyk7XG5cdH0pO1xuXG5cdCQoJy50aXBfX25hbWUnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHQkKCcuY2FyZCcpLmNzcygnei1pbmRleCcsICcnKTtcblx0XHQkKCcudGlwX19oaWRlY29udGVudCcpLmhpZGUoKTtcblx0XHQkKHRoaXMpLnBhcmVudCgpLmZpbmQoJy50aXBfX2hpZGVjb250ZW50Jykuc2hvdygpO1xuXHRcdCQodGhpcykuY2xvc2VzdCgnLmNhcmQnKS5jc3MoJ3otaW5kZXgnLCAnMicpO1xuXHR9KTtcblxuXHR2YXIgZGF0YVNsaWRlcnMgPSB7XG5cdFx0ZmVhdXR1cmVzOiB7XG5cdFx0XHRpdGVtczogNixcblx0XHRcdG5hdjogdHJ1ZVxuXHRcdH0sXG5cdFx0Z2FsbGVyeToge1xuXHRcdFx0aXRlbXM6IDQsXG5cdFx0XHRuYXY6IHRydWUsXG5cdFx0XHRtb3VzZURyYWc6IGZhbHNlXG5cdFx0fVxuXHR9XG5cblx0JCgnW2RhdGEtc2xpZGVyXScpLmVhY2goZnVuY3Rpb24oaSwgc2xpZGVyKSB7XG5cdFx0dmFyIGRhdGEgPSAkKHRoaXMpLmRhdGEoJ3NsaWRlcicpO1xuXG5cdFx0JChzbGlkZXIpLm93bENhcm91c2VsKGRhdGFTbGlkZXJzW2RhdGFdKVxuXHR9KTtcblxuXHQvLyBHYWxsZXJ5XG5cdCQoJy5nYWxsZXJ5X19lbGVtZW50Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5jbG9zZXN0KCcuZ2FsbGVyeV9fbGlzdCcpLmZpbmQoJy5nYWxsZXJ5X19lbGVtZW50X2FjdGl2ZScpLnJlbW92ZUNsYXNzKCdnYWxsZXJ5X19lbGVtZW50X2FjdGl2ZScpO1xuXHRcdCQodGhpcykuYWRkQ2xhc3MoJ2dhbGxlcnlfX2VsZW1lbnRfYWN0aXZlJyk7XG5cblx0XHRpZiAoJCh0aGlzKS5oYXNDbGFzcygnZ2FsbGVyeV9fZWxlbWVudF92aWRlbycpKSB7XG5cdFx0XHRjb25zb2xlLmxvZygndmlkZW8nKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dmFyIGltZyA9ICQodGhpcykuZmluZCgnaW1nJykuY2xvbmUoKTtcblxuXHRcdFx0JCh0aGlzKS5jbG9zZXN0KCcuZ2FsbGVyeScpLmZpbmQoJy5nYWxsZXJ5X192aWV3JykuZW1wdHkoKS5hcHBlbmQoaW1nKTtcblx0XHR9XG5cblxuXHR9KTtcblxuXHRpbml0KCk7XG5cbn0pKHdpbmRvdyk7XG4iXX0=
